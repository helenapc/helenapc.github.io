// 5566677174GD756E6B6B7E717A767A6A456C72666E7133687472GD6666GD66677A6A257266OG35393C3C353E3D3EOG66677A6A3C3739373C38OG576A787A726A733F2546677A6A3C3739373C38Q0666866696A726E66252D75696B2EOG6D6A716A736675683735363D456C72666E7133687472OG666866696A726E666D6A716A7366OGQ0666974676A250x1f4a9OG756E6B6B7E717A767A6A456C72666E7133687472OG596D7A716E74753739666974676A2FOGQ0666E776977746E69OG756E6B6B7E717A767A6A456C72666E7133687472OG796D7A716E747537392FOGQ0667A79746D7479706A7EOG756E6B6B7E717A767A6AOG796D7A716E74753739OGQ0676E6C25796E726AOG6D6A716A736675683735363D456C72666E7133687472OG6D6A716A7366676E6COGQ0686667716A7B6E786E7473256B6E676A77796A71OG756E6B6B35353664363638456D747972666E7133687472OG796D7A716E7475OGQ06866737B66OG6D6A716A736675683735363D456C72666E7133687472OG6D6A716A736675686866737B663735363DOG6D6A716A73667568Q0686C797766696A77OG6D6A716A736675683735363D456C72666E7133687472OG796D7A716E74753739OGQ0686D6A787833687472OG6D6A716A736675683735363DOG796D7A716E74753739OGQ068716E75686D667275256A696E79747725696A257B6E696A74OG6D6A716A736675683735363D456C72666E7133687472OG32OG6D6A716A736625717A767A6AQ06874696A66737E7C6D6A776AOG6D6A716A736675683735363D456C72666E7133687472OG6D6A716A736675686874696A3739OG576A72747B6A77256A73253C2569F2667833Q06874696A756A73OG6D6A716A736675683735363DOG796D7A716E74756874696A756A73OGQ069666B747379OG7566677174717A767A6AOG796D7A716E747569666B747379OGQ0696E7868747769OG6D6A716A736675683735363D456C72666E7133687472OG796D7A716E7475696E78683739747769OG7566677174717A767A6AQ0696E7D756A77336C6COG6D6A716A736675683735363D456C72666E7133687472OG6D6A716A7366696E7D756A77OGQ06977747567747DOG756E6B6B7E717A767A6A456C72666E7133687472OG796D7A716E74753739OGQ06A78747A736925727A786E68OG6D6A716A736675683735363D456C72666E7133687472OG796D7A716E74753739OGQ06A787966686E7473257571667EOG756E6B6B7E717A767A6A456C72666E7133687472OG596D7A716E74753739OG53747267776A2527556667717427Q06B66686A67747470OG756E6B6B35353664363638456D747972666E7133687472OG796D7A716E74753739OGQ06B66687A7179666925696A25686E6A73686E6678257366797A7766716A78OG7566677174717A767A6AOG596D7A716E747537392FOGQ06B6E6C7266OG6D6A716A736675683735363D456C72666E7133687472OG6B6E6C72666D596D7A716E7475OGQ06B776A6A3869OG6D6A716A73667568OG6D6A716A736675686B776A6A3869OGQ06C6A746C6A677766OG6D6A716A736675683735363DOG6C6A74796D7A716E74756C6A6777663739OGQ06C6E796D7A67OG6D6A716A73667568OG796D7A716E747537396C6E79OGQ06C74746C716A2566677A6AOG66677A6A66677A6A3D3C456C72666E7133687472OG796D7A716E74753739OGQ06C74746C716A256DOG6D6A716A736675683735363D456C72666E7133687472OG767C6A363738565COGQ06C74746C716A2575OG756E6B6B7E717A767A6A456C72666E7133687472OG756E6B6B6E66796E6874373E48464846OGQ06C7774747B6A256E75OG66677A6A66677A6A3D3C456C72666E7133687472OG796D7A716E74753739OGQ06D6A7774707AOG6D6A716A736675683735363D456C72666E7133687472OG796D7A716E747537392F6D6A7774707AOGQ06D747972666E713274736A69776E7B6AOG756E6B6B35353664363638456D747972666E7133687472OG796D7A716E74753739OGQ06D747E7978OG756E6B6B35353664363638456D747972666E7133687472OG796D7A716E74753739OGQ06E7025667275716E797A676AOG6D6A716A73667568OG6D6A716A7366667275OGQ06E737879666C776672OG7566677174717A767A6A3D3DOG796D7A716E747537396E73787966OGQ06E737879666C776672OG75716C7766756D6E6878OG796D7A716E74753739OGQ06F667B662574776668716AOG6D6A716A736A736675683735363D456C72666E7133687472OG596D7A716E747537394F667B66OGQ0726A6C66256DOG6D6A716A736675683735363D456C72666E7133687472OG6D6A716A73667568726A6C66OGQ0726A6C6625756EOG756E6B6B35353664363638456D747972666E7133687472OG796D7A716E747537396D747972666E71OGQ0726A6C662575OG756E6B6B7E717A767A6A456C72666E7133687472OG796D7A716E74753739OGQ0726E68777478746B79OG756E6B6B35353664363638456D747972666E7133687472OG796D7A716E74753739OGQ07274796E747325667777667EOG756E6B6B7E717A767A6A456C72666E7133687472OG796D7A716E7475727479667777OG596A72757766796A7825696A257B6E696A74Q073667766736F66OG3232OG3A3D39353B3AOG3D3D3C37Q0736A796B716E7DOG72667D6E647866736C6667776E6A71456D747972666E7133687472OG796E3D796629796E3E716628OGQ0737B6E696E66OG756E6B6B7E717A767A6A456C72666E7133687472OG596D7A716E7475737B6E696E663739OGQ075667E756671OG75456C72666E7133687472OG596D7A716E747537392F7575OG596D7A716E747537392F7575Q0756A777874736671OG383D3C393A37363D3D3COG3D3D3C3A37OGQ0757E756EOG756E6B6B7E717A767A6AOG596D7A716E747537392F2FOG487A6A73796625696A2572F8697A71747825696A25757E796D747333Q07868776E6769OG756E6B6B7E717A767A6A456C72666E7133687472OG796D7A716E74753739OGQ0786D746C6E257571667E747033687472OG7566677174717A767A6AOG75786D746C6EOGQ0786E696A6B7DOG756E6B6B7E717A767A6A456C72666E7133687472OG796D7A716E74753739OGQ0786E7A256C7A667766736EOG38383C3A383C3B3EOG596D7A716E74753739OG776A7B6E78667744Q0787278257577746B6E79OG756E6B6B7E717A767A6A456C72666E7133687472OG596D7A716E74753739585258OGQ07874737EOG756E6B6B7E717A767A6A456C72666E7133687472OG796D7A716E747537395874737EOGQ078747A73696871747A69OG756E6B6B35353664363638456D747972666E7133687472OG796D7A716E74753739OGQ0787574796E6B7E256DOG6D6A716A736675683735363D456C72666E7133687472OG796D7A716E74753739OGQ0787574796E6B7E2575OG756E6B6B7E717A767A6A456C72666E7133687472OG796D7A716E7475373978OGQ078796A6672OG7566677174717A767A6A37OG796D7A716E74753739OGQ0796A716A687472OG756E6B6B7E717A767A6A456C72666E7133687472OG3D3D3C3A37OGQ0797C6E79796A77OG45796D6A756E6B6B7EOG796D7A716E7475373959OGQ07A667166OG7566677174717A767A6A36353636OG796D7A716E747537395AOG3D3D3C3AQ07A756D747169OG756E6B6B7E717A767A6A456C72666E7133687472OG596D7A716E74753739OGQ07B6E706EOG6D6A716A736675683735363D456C72666E7133687472OG6D6A716A73667B6E706E3735363DOG53747267776A3F254D6A716A7366252D3B343C3437352EQ07C6A667B66OG6D6A716A736675683735363D456C72666E7133687472OG32OG4E736E686E6625687473256C74746C716AQ07E756BOG756E6B6B7E717A767A6A456C72666E7133687472OG596D7A716E74753739OGQ07F747472OG6D6A716A736675683735363D456C72666E7133687472OG796D7A716E747537395FOGQ0
// 4669726E736E78797766697477GD6669726E73GD6669726E73GD36OG37OG38OG39Q0

// NEW MODAL

document.getElementById('bkmodal').addEventListener('click', () => {
    // console.log('hola');
    document.getElementById('bkmodal').setAttribute('style', 'opacity:0; pointer-events: none');
    document.getElementById('modal').setAttribute('style', 'opacity:0; pointer-events: none');
    
    document.getElementById('buttonEdit').setAttribute('style', 'opacity:0; pointer-events: none');
    document.getElementById('buttonDelete').setAttribute('style', 'opacity:0; pointer-events: none');
    // document.getElementById('help-edit').setAttribute('style', `opacity:0; pointer-events: none`);
    // document.getElementById('help-delete').setAttribute('style', `opacity:0; pointer-events: none`);
    // helpFunction('0', false);

    document.querySelectorAll('p.ccse')[0].setAttribute('style', 'user-select:none;');
    document.querySelectorAll('p.ccse')[1].setAttribute('style', 'user-select:none;');
    document.querySelectorAll('p.ccse')[2].setAttribute('style', 'user-select:none;');


    
})



//home
buttonLogin.addEventListener('click', () => {
    barProgressF('success', 'indeterminate');

    localStorage.setItem('accessTempData', code(nameLog.value) + 'GD' + code(passLog.value) + 'GD');

    db.collection(coll).onSnapshot(querySnapshot => {
        querySnapshot.forEach(doc => {
            if (!coincidencia) {
                docB1 = doc.data().B1;
                docB2 = doc.data().B2;
                userID = doc.id;
                uRA = doc.data().B1.split('GD');
                if (docB1.includes(localStorage.getItem('accessTempData'))) {
                    // 
                    localStorage.setItem('tPin', Date.now());
                    // 
                    coincidencia = true;
                    updateDB('B1', 'L1');
                    splitInit();
                    aTotalTOnewTotal();
                    localStorage.setItem('accessTempData', txt[0] + 'GD' + code(nameLog.value) + 'GD' + code(passLog.value) + 'GD'); //TEST
                    document.getElementById('userName').innerHTML = deco(txt[0]);
                    disableItem(false);
                    window.location.reload();
                }
                // res
                if (code(nameLog.value) == uRA[1] && passLog.value == doc.data().B3) {
                    console.log(doc.data().B3);
                    function presentRestorePass() {
                        const alert = document.createElement('ion-alert');
                        alert.subHeader = 'Restablecer contraseña';
                        alert.inputs = [
                            { name: 'pass01', placeholder: 'Nueva contraseña...', value: '' },
                            { name: 'pass02', placeholder: 'Confirmar contraseña...', value: '' }
                        ];
                        alert.buttons = [
                            { text: 'Cancelar', role: 'cancel' },
                            {
                                text: 'Ok',
                                handler: usRData => {
                                    if (usRData.pass01 == '' || usRData.pass02 == '' || usRData.pass01 != usRData.pass02) {
                                        alertMsg('Error', 'Datos incorrectos o vacíos.');
                                        return;
                                    }



                                    localStorage.setItem('L1', uRA[0] + 'GD' + uRA[1] + 'GD' + code(usRData.pass01) + 'GD' + uRA[3]);
                                    localStorage.setItem('accessTempData', uRA[1] + 'GD' + code(usRData.pass01) + 'GD')
                                    updateDB('L1', 'B1');
                                    updateDB('L1', 'B2');
                                    splitInit();
                                    aTotalTOnewTotal();
                                    document.getElementById('userName').innerHTML = deco(txt[0]);
                                    disableItem(false);

                                    db.collection(coll).doc(userID).update({
                                        B3: firebase.firestore.FieldValue.delete()
                                    }).then(function () { window.location.reload() });


                                },
                            },
                        ];
                        document.body.appendChild(alert);
                        return alert.present();
                    }
                    presentRestorePass();
                    coincidencia = true;
                }
            };

        });
        barProgressF('light', 'determinate');
        if (coincidencia) {
            showLogin.innerHTML = '';
        } else {
            barProgressF('warning', 'determinate');
            alertMsg('Error', 'Datos incorrectos o vacíos.');
            setTimeout(() => { barProgressF('light', 'determinate'); }, 1500);
        }
    });

});

buttonCreate.addEventListener('click', () => {
    function presentAlertCreate() {
        const alert = document.createElement('ion-alert');
        alert.header = 'Registrarse';
        alert.inputs = [
            { name: 'userEditName', placeholder: 'Nombre (Opcional)' },
            { name: 'userEditUser', placeholder: 'Email' },
            { name: 'userEditPass', placeholder: 'Contraseña', type: 'password' },
        ];
        alert.buttons = [
            { text: 'Cancelar', role: 'cancel' },
            {
                text: 'Ok',
                handler: usCData => {
                    if (usCData.userEditUser == '' || usCData.userEditPass == '') {
                        barProgressF('warning', 'determinate');
                        alertMsg('Error', 'Datos obligatorios vacíos.');
                        setTimeout(() => { barProgressF('light', 'determinate'); }, 1500);
                        return;
                    };

                    barProgressF('success', 'indeterminate');
                    (code(usCData.userEditName) == '') ? txt[0] = '25' : txt[0] = code(usCData.userEditName);

                    localStorage.setItem('accessTempData', code(usCData.userEditName) + 'GD' + code(usCData.userEditUser) + 'GD' + code(usCData.userEditPass) + 'GD');

                    db.collection(coll).onSnapshot(querySnapshot => {
                        if (!coincidencia) {
                            querySnapshot.forEach(doc => {
                                uCA = doc.data().B1.split('GD');
                                if (!coincidencia && uCA[1] == code(usCData.userEditUser)) {
                                    coincidencia = true;
                                    docB1 = doc.data().B1;
                                    docB2 = doc.data().B2;
                                    userID = doc.id;
                                };
                            });
                        };

                        if (coincidencia) {
                            if (localStorage.getItem('alrt')) {
                                localStorage.removeItem('alrt');
                            } else {
                                barProgressF('light', 'determinate');
                                alertMsgReset('Error', 'Ya hay una cuenta registrada con este email.');
                            }
                            return

                        } else {
                            localStorage.setItem('alrt', code(usCData.userEditUser))
                            db.collection(coll).add({
                                B1: localStorage.getItem('accessTempData'),
                                B2: '',
                            })
                                .then(function () {
                                    updateDB('B1', 'L1');
                                    showLogin.innerHTML = '';
                                    splitInit();
                                    aTotalTOnewTotal();
                                    document.getElementById('userName').innerHTML = deco(txt[0]);
                                    disableItem(false);
                                    barProgressF('light', 'determinate');
                                    window.location.reload();
                                })
                                .catch(function (error) {
                                    console.error('Error adding document: ', error);
                                });
                        };
                    });
                }
            },
        ];

        document.body.appendChild(alert);
        return alert.present();
    }
    presentAlertCreate();
    return;
});


//CONTENT
newSearch.addEventListener('ionInput', () => { refreshData() });




showSearch.addEventListener('click', e => {  //editCard
    // helpFunction('0', false);

    e.preventDefault();
    var xPath = 3;
    // var cuPath = [];

    if (e.path[xPath].localName == 'ion-row') return;
    if (e.path[xPath].innerText == undefined) xPath = 0;
    if (e.path[xPath].innerText == '') xPath = 5;

    cuPath[0] = e.path[xPath].children[0].innerText;
    cuPath[1] = e.path[xPath].children[1].innerText.split('Usuario: ').pop();
    cuPath[2] = e.path[xPath].children[2].innerText.split('Contraseña: ').pop();
    cuPath[3] = e.path[xPath].children[3].innerText.split('Notas: ').pop();

    if (cuPath[3] == 'Notas:') cuPath[3] = '';

    for (i = 0; i < newTotal.length; i += 5) {
        if (
            cuPath[0].toLowerCase() == newTotal[i].toLowerCase() &&
            cuPath[1] == newTotal[i + 1] &&
            cuPath[2] == newTotal[i + 2] &&
            cuPath[3] == newTotal[i + 3]
        ) {
            // const reemplace = i
            reemplace = i
            alertView2(cuPath);
            document.getElementById('modal').setAttribute('style', 'opacity:1; pointer-events: auto');
            document.getElementById('bkmodal').setAttribute('style', 'opacity:0.5; pointer-events: auto');
            document.getElementById('buttonEdit').setAttribute('style', 'opacity:1; pointer-events: auto');
            document.getElementById('buttonDelete').setAttribute('style', 'opacity:1; pointer-events: auto');


            // var matches = document.querySelectorAll('p.ccse');
            // console.log(matches);
            document.querySelectorAll('p.ccse')[0].setAttribute('style', 'user-select:all;');
            document.querySelectorAll('p.ccse')[1].setAttribute('style', 'user-select:all;');
            document.querySelectorAll('p.ccse')[2].setAttribute('style', 'user-select:all;');
        
        }
    }

});

document.getElementById('refresher').addEventListener('ionRefresh', () => {
    setTimeout(() => {
        window.location.reload();
        document.getElementById('refresher').complete();
    }, 150);
});



//NAV BAR

// document.getElementById('barOpen').addEventListener('click', () => { helpFunction('0', false) });

document.getElementById('barClose').addEventListener('click', () => { barMenuPrincipal.close() });

barImport.addEventListener('click', () => {
    barMenuPrincipal.close();
    function alertImp() {
        const alert = document.createElement('ion-alert');
        alert.setAttribute('backdrop-dismiss', 'false');
        alert.subHeader = '¿Cargar copia de seguridad?';
        alert.buttons = [
            { text: 'cancelar', role: 'cancel' },
            {
                text: 'Confirmar',
                handler: () => {
                    barProgressF('success', 'indeterminate');
                    showSearch.innerHTML = '';
                    newSearch.value = '';
                    updateDB('B2', 'L1');
                    splitInit();
                    aTotalTOnewTotal();
                    document.getElementById('userName').innerHTML = deco(txt[0]);
                    updateDB('L1', 'B1');
                    refreshData();
                    setTimeout(() => {
                        presentToast('Copia de seguridad cargada.', 800, 'success');
                        barProgressF('light', 'determinate');
                    }, 800);
                },
            },
        ];
        document.body.appendChild(alert);
        return alert.present();
    }
    alertImp();
});

barExport.addEventListener('click', () => {
    barMenuPrincipal.close();
    function alertExp() {
        const alert = document.createElement('ion-alert');
        alert.setAttribute('backdrop-dismiss', 'false');
        alert.subHeader = '¿Crear copia de seguridad?';
        alert.buttons = [
            { text: 'cancelar', role: 'cancel' },
            {
                text: 'Confirmar',
                handler: () => {
                    barProgressF('success', 'indeterminate');
                    updateDB('L1', 'B2')
                    setTimeout(() => {
                        presentToast('Copia de seguridad cargada.', 800, 'success');
                        barProgressF('light', 'determinate');
                    }, 800);
                },
            },
        ];
        document.body.appendChild(alert);
        return alert.present();
    }
    alertExp();
});

barLogout.addEventListener('click', () => {
    barMenuPrincipal.close();
    localStorage.clear();
    window.location.reload();
});

barDelAcc.addEventListener('click', () => {
    barMenuPrincipal.close();
    function deleteData() {
        barProgressF('danger', 'determinate');
        const alert = document.createElement('ion-alert');
        alert.header = '¡Advertencia!';
        alert.subHeader = '¿Desea eliminar la cuenta y todos sus datos permanentemente?';
        alert.buttons = [
            { text: 'cancelar', role: 'cancel', handler: () => { barProgressF('light', 'determinate') } },
            {
                text: 'confirmar',
                handler: () => {
                    console.log(userID);
                    Email.send({
                        Host: "smtp.gmail.com",
                        Username: "restore.pass.helena@gmail.com",
                        Password: "restaurar1234",
                        To: deco(txt[1]),
                        From: "restore.pass.helena@gmail.com",
                        Subject: "Eliminar cuenta.",
                        Body:
                            `
                            <h2>Clave para confirmar la eliminación de la cuenta:</h2>
                            <h1>${userID}</h1>
                        `,
                    }).then(function () {
                        console.log("correo enviado");
                    }).catch(function (error) {
                        console.error("Error removing document: ", error);
                    });

                    function confirmVoid() {
                        const alert = document.createElement('ion-alert');
                        alert.setAttribute('backdrop-dismiss', 'false');
                        alert.subHeader = 'Complete los datos para terminar el proceso.'
                        alert.message = '(Se envió por correo la clave para confirmar el proceso).'

                        alert.inputs = [
                            { name: 'avoid', placeholder: 'Usuario' },
                            { name: 'bvoid', placeholder: 'Contraseña' },
                            { name: 'cvoid', placeholder: 'Clave de confirmación' },
                        ];
                        alert.buttons = [
                            {
                                text: 'Ok',
                                handler: (x) => {
                                    if (txt[1] == code(x.avoid) && txt[2] == code(x.bvoid) && userID == x.cvoid) {
                                        barProgressF('danger', 'indeterminate');
                                        localStorage.setItem('L1', localStorage.getItem('L1') + 'aa');
                                        updateDB('L1', 'B1');

                                        setTimeout(() => {
                                            db.collection(coll).doc(userID).delete()
                                                .then(function () {
                                                    console.log("Document successfully deleted!");
                                                    setTimeout(() => { presentToast('Borrando.', '800', 'danger'); }, 2500); //probar
                                                }).catch(function (error) {
                                                    console.error("Error removing document: ", error);
                                                });
                                        }, 2000);
                                    } else {
                                        barProgressF('light', 'determinate');
                                        presentToast('Incorrecto.', '800', 'warning');
                                    }
                                }
                            },
                            { text: 'cancelar', role: 'cancel', handler: () => { barProgressF('light', 'determinate') } },

                        ]
                        document.body.appendChild(alert);
                        return alert.present();


                    };
                    confirmVoid();

                }
            }
        ];
        document.body.appendChild(alert);
        return alert.present();
    }
    deleteData();
});



//FAB

document.getElementById('buttonEdit').addEventListener('click', () => {
    // helpFunction('0', false);
    alertEdit(cuPath, reemplace);
})

document.getElementById('buttonDelete').addEventListener('click', () => {
    // helpFunction('0', false);
    alertDel(cuPath, reemplace);
})

// document.getElementById('buttonHelp').addEventListener('click', () => {
//     (!helpActivate) ? helpFunction('1', true) : helpFunction('0', false);
//     (!helpActivate) ? helpLabel('1', true) : helpLabel('0', false);
//     console.log('aiuda');
// });

document.getElementById('nameSetting').addEventListener('click', () => {
    // helpFunction('0', false);
    alertPass();
    // presentPin();
});

document.getElementById('expandCard').addEventListener('click', () => {
    // helpFunction('0', false);
    if (document.getElementById('expandIcon').getAttribute('name') == icoExp) {
        document.getElementById('expandIcon').setAttribute('name', icoCom)
    } else {
        document.getElementById('expandIcon').setAttribute('name', icoExp)
    };
    refreshData(false);
});

document.getElementById('showCard').addEventListener('click', () => {
    // helpFunction('0', false);
    if (document.getElementById('showIcon').getAttribute('name') == icoShow) {
        document.getElementById('showIcon').setAttribute('name', icoHide);
        newSearch.value = '*';
        newSearch.setAttribute('style', 'margin-top:-60px');
    } else {
        document.getElementById('showIcon').setAttribute('name', icoShow);
        newSearch.value = '';
    };
    refreshData();
});

document.getElementById('buttonSearch').addEventListener('click', () => {
    // helpFunction('0', false);
    if (!statSearchBar) {
        newSearch.value = '';
        newSearch.setAttribute('style', 'margin-top:0px');
        newSearch.setFocus();
        statSearchBar = true;
    } else {
        newSearch.setAttribute('style', 'margin-top:-60px');
        statSearchBar = false;
    }

})

document.getElementById('buttonAdd').addEventListener('click', () => {
    // helpFunction('0', false);
    // document.getElementById('help-add').setAttribute('style', 'opacity:0');
    function presentAlertAdd() {
        const alert = document.createElement('ion-alert');
        alert.setAttribute('backdrop-dismiss', 'false');
        alert.header = 'Agregar cuenta';
        alert.inputs = [
            { name: 'name1a', placeholder: 'Cuenta(Nombre):', value: '' },
            { name: 'name2a', placeholder: 'Usuario/email:', value: '' },
            { name: 'name3a', placeholder: 'Contraseña:', value: '' },
            { name: 'name4a', placeholder: 'Notas(Opcional):', value: '' },
        ];
        alert.buttons = [
            { text: 'Cancelar', role: 'cancel' },
            {
                text: 'Ok',
                handler: newData2 => {
                    if (
                        newData2.name1a == '' ||
                        newData2.name2a == '' ||
                        newData2.name3a == ''
                    ) {
                        barProgressF('warning', 'determinate');
                        alertMsg('Error', 'Datos obligroios vacíos.');
                        setTimeout(() => { barProgressF('light', 'determinate'); }, 1500);
                        return;
                    }

                    for (let i = 0; i < newTotal.length; i += 5) {
                        if (
                            newData2.name1a == newTotal[i] &&
                            newData2.name2a == newTotal[i + 1] &&
                            newData2.name3a == newTotal[i + 2]
                        ) {
                            alertMsg('Error', `La cuenta ${newTotal[i]} ya existe.`);
                            return;
                        }
                    }

                    aTotal.push(`${code(newData2.name1a.toLowerCase())}OG${code(newData2.name2a)}OG${code(newData2.name3a)}OG${code(newData2.name4a)}`)
                    aTotalTOnewTotal();
                    save();
                    showSearch.innerHTML = '';
                    newSearch.value = newData2.name1a;
                    // document.getElementById('expandIcon').setAttribute('name', 'contract-outline');
                    document.getElementById('expandIcon').setAttribute('name', icoCom);
                    refreshData();
                    presentToast(`"${newData2.name1a.toUpperCase()}" agregada`, 800, 'success');
                    updateDB('L1', 'B1');
                },
            },
        ];
        document.body.appendChild(alert);
        return alert.present();
    }
    presentAlertAdd();
});




//CHECK/TOGGLE
checkbox.addEventListener('click', () => {
    // helpFunction('0', false);
    if (activeTheme[1] == 'dark') {
        document.body.classList.toggle('dark');
        document.body.classList.toggle(activeTheme[0]);
        activeTheme[1] = '';
    } else {
        document.body.classList.toggle(activeTheme[0]);
        document.body.classList.toggle('dark');
        activeTheme[1] = 'dark';
    }
    localStorage.setItem('theme', activeTheme);
});
